<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>prototype view resident</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div id="header-div"><h1>Bonjour resident</h1></div>
<div id="div-request-box">
    <table id="table-request">
        <tr>
            <th>Numéro de requête</th>
            <th>Arrondissement</th>
            <th>Type</th>
            <th>Status</th>
            <th>Catégorie du prestataire</th>
            <th>Nom de l'organisation</th>
        </tr>

    </table>
</div>

<div id="button-panel">
    <button id="request-add-button" onclick="addRequestButton()"> Signaler un problème </button>
    <br>
    <label for="Address">Addresse du probleme?</label>
    <input type="text" id="Address">
    <br>
    <label for="type-probleme">Quelle categorie decrit le probleme le mieux</label>
    <select id="type-probleme" name="type-prob-choose">
        <option value="Travaux routiers">Travaux routiers</option>
        <option value="Travaux de gaz ou électricité">Travaux de gaz ou électricité</option>
        <option value="Construction ou rénovation">Construction ou rénovation</option>
        <option value="Entretien paysager">Entretien paysager</option>
        <option value="Travaux liés aux transports en commun">Travaux liés aux transports en commun</option>
        <option value="Travaux de signalisation et éclairage">Travaux de signalisation et éclairage</option>
        <option value="Travaux souterrains">Travaux souterrains</option>
        <option value="Travaux résidentiel">Travaux résidentiel</option>
        <option value="Entretien urbain">Entretien urbain</option>
        <option value="Entretien des réseaux de télécommunication">Entretien des réseaux de télécommunication</option>
    </select>




    <button id="request-add-button" > Inscription aux alertes des travaux </button>
    <button id="request-add-button" > Accéder au registre des travaux </button>
</div>

<script src="script.js"></script>

<script>
    const apiURL = "https://donnees.montreal.ca/api/3/action/datastore_search?resource_id=cc41b532-f12d-40fb-9f55-eb58c9a2b12b&limit=10";


    async function loadRequests() {
        try {
            const response = await fetch(apiURL);
            const data = await response.json();
            const records = data.result.records;

            const table = document.getElementById("table-request");


            records.forEach(record => {
                const row = document.createElement("tr");
                row.innerHTML = `
                <td>${record.id || "N/A"}</td>
                <td>${record.boroughid || "N/A"}</td>
                <td>${record.reason_category || "N/A"}</td>
                <td>${record.currentstatus || "N/A"}</td>
                <td>${record.submittercategory || "N/A"}</td>
                <td>${record.organizationname || "N/A"}</td>
`;
                table.appendChild(row);
            });
        } catch (error) {
            console.error("Erreur lors du chargement des données :", error);
        }
    }

    // Charger les données dès que la page s’ouvre
    loadRequests();
</script>

</body>
</html>